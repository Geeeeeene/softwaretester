# 🚀 Catch2 单元测试 - 快速开始

## 第一步：安装前端依赖

**请在终端运行**：
```bash
cd frontend
npm install react-syntax-highlighter @types/react-syntax-highlighter
```

## 第二步：重启前端（如果正在运行）

如果前端正在运行，按 `Ctrl+C` 停止，然后重新运行：
```bash
npm run dev
```

## 第三步：创建单元测试项目

1. 打开浏览器：`http://localhost:5173`
2. 点击"创建项目"
3. **项目类型**：选择 **"单元测试"**
4. **项目名称**：输入 "我的C++测试"
5. 点击"创建项目" ✅

## 第四步：上传源代码

1. 进入刚创建的项目详情页
2. 点击 **"上传源代码"** 按钮
3. 选择一个包含 C++ 源代码的 `.zip` 文件
   - 可以包含 `.cpp`, `.h`, `.hpp` 等文件
   - 会自动解压到服务器
4. 上传成功！✅

## 第五步：进入单元测试页面

在项目详情页，找到并点击：
```
🧪 Catch2 单元测试
```
这个蓝色按钮

## 第六步：生成测试用例

### 6.1 选择源文件
- 页面会列出所有 C++ 源文件
- 点击选择一个你想测试的文件（例如 `calculator.cpp`）

### 6.2 添加说明（可选）
在"额外说明"框中输入：
```
这是一个计算器类，包含加减乘除功能
```

### 6.3 生成测试
点击 **"生成用例"** 按钮
- AI 会自动分析你的代码
- 生成 Catch2 格式的测试代码
- 包含多个 TEST_CASE

### 6.4 查看生成的代码
- 代码会高亮显示
- 可以点击"复制代码"
- 可以在下方编辑框中修改

## 第七步：执行测试

点击 **"开始测试"** 按钮
- 系统会自动编译测试代码
- 运行 Catch2 测试
- 收集代码覆盖率

## 第八步：查看结果

测试完成后，你会看到：

### 📊 测试摘要
- 总测试数：5
- 通过：4 ✅
- 失败：1 ❌
- 通过率：80%

### 📈 代码覆盖率
- 总体覆盖率：87.3%
- 行覆盖率：45/52
- 分支覆盖率：12/15

### 📝 执行日志
```
✅ 编译成功
✅ 运行测试...
TEST_CASE: add() - PASSED
TEST_CASE: subtract() - PASSED
...
```

---

## 🎯 完整流程示例

```
1. 创建项目 "计算器测试" (类型: 单元测试)
   ↓
2. 上传 calculator.zip (包含 calculator.cpp, calculator.h)
   ↓
3. 进入 "Catch2 单元测试" 页面
   ↓
4. 选择 calculator.cpp
   ↓
5. 点击 "生成用例" → AI 生成 Catch2 测试
   ↓
6. 查看/编辑生成的测试代码
   ↓
7. 点击 "开始测试" → 运行 Catch2
   ↓
8. 查看测试结果 + 覆盖率
```

---

## ❓ 常见问题

### Q1: "未找到 C++ 源文件"
**答**: 请确保上传的 zip 文件中包含 `.cpp` 或 `.c` 文件

### Q2: "生成测试失败"
**答**: 检查后端日志，可能是 Claude API 配置问题
- 检查 `backend/app/core/config.py` 中的 `CLAUDE_API_KEY`
- 确保 `CLAUDE_BASE_URL = "https://work.poloapi.com"`

### Q3: "编译失败"
**答**: 确保安装了 g++ 编译器
- Windows: 安装 MinGW-w64
- Linux: `sudo apt install g++`

### Q4: 找不到"Catch2 单元测试"按钮
**答**: 
1. 确保创建的项目类型是 **"单元测试"**（不是"静态分析"）
2. 确保已安装前端依赖：`react-syntax-highlighter`
3. 确保前端已重启

---

## 🎉 现在就试试吧！

只需运行：
```bash
cd frontend
npm install react-syntax-highlighter @types/react-syntax-highlighter
```

然后刷新页面，创建一个单元测试项目！

