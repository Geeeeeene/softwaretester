# 前端操作演示指南 - 验证工作完成

本指南将展示如何在前端操作，证明 Clazy 和 Cppcheck 静态分析工具已成功集成。

## 📋 验证步骤

### 步骤 1: 访问前端

1. **打开浏览器**
2. **访问**: http://localhost:5173
3. **确认页面正常加载**

---

### 步骤 2: 创建静态分析项目

#### 方法 A: 使用前端界面（如果按钮可用）

1. **点击"项目管理"**（顶部导航栏或首页）
2. **点击"创建项目"按钮**（右上角）
3. **填写项目信息**：
   - **项目名称**: `C++ 静态分析项目`
   - **项目描述**: `使用 Clazy 和 Cppcheck 进行代码分析`
   - **项目类型**: 选择 **"静态分析"** ⭐
   - **编程语言**: `C++`
   - **框架**: `Qt`（如果是 Qt 项目）
   - **源代码路径**: `./src`（可选）
4. **点击"创建项目"**

#### 方法 B: 如果按钮点不了，使用浏览器控制台

1. **按 F12 打开开发者工具**
2. **切换到 Console 标签**
3. **复制粘贴以下代码**：

```javascript
// 创建静态分析项目
fetch('http://localhost:8000/api/v1/projects', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({
    name: 'C++ 静态分析项目',
    description: '使用 Clazy 和 Cppcheck 进行代码分析',
    project_type: 'static',
    language: 'C++',
    framework: 'Qt'
  })
})
.then(r => r.json())
.then(data => {
  console.log('✅ 项目创建成功！', data);
  alert('项目创建成功！ID: ' + data.id + '\n页面将自动刷新...');
  setTimeout(() => window.location.href = '/projects', 1000);
})
.catch(e => {
  console.error('❌ 失败:', e);
  alert('创建失败: ' + e.message);
});
```

4. **按 Enter 执行**
5. **等待页面跳转到项目管理页面**

---

### 步骤 3: 进入项目详情

1. **在项目列表中，点击刚创建的项目卡片**
2. **或直接访问**: http://localhost:5173/projects/[项目ID]
   - 项目ID可以在浏览器控制台看到，或从项目列表卡片中获取

---

### 步骤 4: 创建测试用例并选择工具

1. **在项目详情页，点击"测试用例"按钮**
2. **点击"创建用例"按钮**
3. **填写测试用例信息**：

#### 基本信息
- **测试用例名称**: `Clazy 代码质量检查` 或 `Cppcheck 代码质量检查`
- **描述**: `使用 Clazy/Cppcheck 检查代码质量问题`

#### ⭐ 关键步骤：选择工具
- **静态分析工具**: 
  - 选择 **"Clazy - Qt 静态分析"** 或
  - 选择 **"Cppcheck - C/C++ 静态分析"**

#### 配置分析目标
- **目标文件**: 
  - 添加文件路径，例如：`src/main.cpp`
  - 或使用通配符：`src/**/*.cpp`
- **目标目录**: 
  - 例如：`src/core`

#### 工具特定配置
- **如果选择 Clazy**:
  - Clazy 检查级别: 选择 `Level 1 - 默认级别，误报很少`
  
- **如果选择 Cppcheck**:
  - Cppcheck 检查类型: 选择 `全部检查`

4. **点击"创建测试用例"**

---

### 步骤 5: 验证工具选择成功

创建测试用例后，你应该看到：

1. **测试用例卡片显示**：
   - 测试用例名称
   - **工具标签**（显示 "Clazy" 或 "Cppcheck"）⭐
   - 目标文件数量

2. **在测试用例列表中**：
   - 每个测试用例卡片右上角有工具标识
   - 可以清楚看到使用了哪个工具

---

### 步骤 6: 验证后端执行器（可选）

如果你想验证执行器是否正常工作：

1. **打开 API 文档**: http://localhost:8000/docs
2. **找到 `/api/v1/test-cases` 接口**
3. **查看刚创建的测试用例**：
   - 点击 `GET /api/v1/test-cases`
   - 点击 "Try it out"
   - 输入 `project_id`（你的项目ID）
   - 点击 "Execute"
   - 查看返回的 `test_ir` 字段，应该包含 `tool: "clazy"` 或 `tool: "cppcheck"`

---

## ✅ 验证清单

完成以下操作，证明工作已成功：

- [ ] ✅ 能够创建静态分析类型的项目
- [ ] ✅ 能够进入项目详情页
- [ ] ✅ 能够创建测试用例
- [ ] ✅ **能够看到工具选择界面（Clazy/Cppcheck）** ⭐
- [ ] ✅ **能够选择 Clazy 工具** ⭐
- [ ] ✅ **能够选择 Cppcheck 工具** ⭐
- [ ] ✅ 创建测试用例后能看到工具标识
- [ ] ✅ 测试用例的 Test IR 中包含 `tool` 字段

---

## 🎯 关键验证点

### 1. 工具选择界面
**验证位置**: 创建测试用例表单中

**应该看到**:
```
静态分析工具 *
○ Clazy - Qt 静态分析
  用于 Qt 代码的静态分析工具
● Cppcheck - C/C++ 静态分析
  用于 C/C++ 代码的静态分析工具
```

### 2. 工具标识显示
**验证位置**: 测试用例列表卡片

**应该看到**:
- 卡片右上角有蓝色标签显示 "Clazy" 或 "Cppcheck"

### 3. Test IR 数据
**验证位置**: API 响应或数据库

**应该包含**:
```json
{
  "type": "static",
  "tool": "clazy",  // 或 "cppcheck"
  "name": "...",
  "target_files": [...],
  "checks": ["level1"]  // Clazy 特有
  // 或
  "enable": "all"  // Cppcheck 特有
}
```

---

## 🐛 如果遇到问题

### 问题 1: 创建项目按钮点不了

**解决方案**:
- 使用浏览器控制台方法（方法 B）
- 或访问 API 文档直接创建

### 问题 2: 看不到工具选择

**检查**:
1. 确保项目类型是 "static"
2. 刷新页面（Ctrl+F5）
3. 检查浏览器控制台是否有错误

### 问题 3: 测试用例创建失败

**检查**:
1. 浏览器控制台错误信息
2. 后端日志: `docker-compose logs backend`
3. 确保至少填写了项目名称和目标文件

---

## 📸 截图建议

为了证明工作完成，建议截图：

1. **工具选择界面** - 显示 Clazy 和 Cppcheck 选项
2. **创建后的测试用例列表** - 显示工具标识
3. **API 响应** - 显示 test_ir 中的 tool 字段

---

## 🎉 完成标志

当你能够：
1. ✅ 创建静态分析项目
2. ✅ 在创建测试用例时看到工具选择（Clazy/Cppcheck）
3. ✅ 成功选择工具并创建测试用例
4. ✅ 在测试用例列表中看到工具标识

**恭喜！你的工作已经成功完成！** 🎊


